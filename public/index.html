<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Welcome to Firebase Hosting</title>
    <style media="screen">
      body {
        font-family: Roboto, Arial, sans-serif;
        background: #ECEFF1;
        color: rgba(0,0,0,0.87);
      }

      a {
        color: rgb(3,155,229);
      }

      #message {
        max-width: 400px;
        margin: 40px auto;
        box-shadow: 0 1px 3px 0 rgba(0,0,0,0.2),0 1px 1px 0 rgba(0,0,0,0.14),0 2px 1px -1px rgba(0,0,0,0.12);
        border-radius: 2px;
        background: white;
        padding: 16px 24px;
      }

      #message h1 {
        font-size: 22px;
        font-weight: 500;
        text-align: center;
        margin: 0 0 16px;
      }

      #message p {
        font-weight: 300;
        line-height: 150%;
      }

      #message ul {
        list-style: none;
        margin: 16px 0 0;
        padding: 0;
        text-align: center;
      }

      #message li a {
        display: inline-block;
        padding: 8px;
        text-transform: uppercase;
        text-decoration: none;
        font-weight: 500;
        background: rgb(3,155,229);
        color: white;
        border: 1px solid rgb(3,155,229);
        border-radius: 3px;
        font-size: 14px;
        box-shadow: 0 2px 5px 0 rgba(0,0,0,.26);
      }
    </style>
  </head>
  <body>
    <!-- TODO: Use npm + webpack to install this locally and factor everything out. -->
    <script src="https://www.gstatic.com/firebasejs/live/3.0/firebase.js"></script>
    <script>
      // Initialize Firebase
      var config = {
        apiKey: "AIzaSyAHsBIF67mHchYUg0vtOtRpWw0r268-bZ8",
        authDomain: "simple-one-on-one.firebaseapp.com",
        databaseURL: "https://simple-one-on-one.firebaseio.com",
        storageBucket: "simple-one-on-one.appspot.com",
      };
      firebase.initializeApp(config);


      var provider = new firebase.auth.GoogleAuthProvider();

      var login = function () {
        firebase.auth().signInWithPopup(provider).then(function(result) {
          // This gives you a Google Access Token. You can use it to access the Google API.
          var token = result.credential.accessToken;
          // The signed-in user info.
          var user = result.user;
          // ...
          console.log(user)
        }).catch(function(error) {
          // Handle Errors here.
          var errorCode = error.code;
          var errorMessage = error.message;
          // The email of the user's account used.
          var email = error.email;
          // The firebase.auth.AuthCredential type that was used.
          var credential = error.credential;
          // ...
          console.log(error);
        });
      };

      
      var createNewNote = function(userId, title, message, peepId) {
        var timestamp = firebase.database.ServerValue.TIMESTAMP;
        var database = firebase.database();

        var newNoteKey = database.ref(userId).child("notes").push().key;

        var newNote = {
          "timestamp" : timestamp,
          "title" : title,
          "message" : message
        };
        if (peepId) {
          newNote["peep_id"] = peepId;
        }

        var updates = {}
        updates["/notes/" + newNoteKey] = newNote;

        database.ref(userId).update(updates)
          .then(function(result) {
            // Success + show.
          })
          .catch(function(error) {
            // Failure! hide.
          });
      }

    </script>
    <div id="message">
      <h1>Welcome to Firebase Hosting</h1>
      <p>You're seeing this because you've successfully setup Firebase Hosting. Now it's time to go build something extraordinary!</p>
      <ul>
        <li><a target="_blank" onclick="login()">login</a></li>
      </ul>
    </div>
  </body>
</html>
